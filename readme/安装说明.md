## Cài đặt
> Yêu cầu môi trường chạy PHP 7.1～7.4, phiên bản cơ sở dữ liệu là Mysql 5.7.
## Cài đặt một cú nhấp chuột
Tạo trang web, thư mục chạy chọn /public dưới thư mục gốc của dự án, thiết lập giả tĩnh là giả tĩnh của thinkphp
Nhập tên miền hoặc IP của bạn vào trình duyệt (ví dụ: www.yourdomain.com),
Chương trình cài đặt sẽ tự động thực hiện cài đặt. Trong quá trình này, hệ thống sẽ nhắc bạn nhập thông tin cơ sở dữ liệu để hoàn tất cài đặt, sau khi cài đặt xong, nên xóa tệp index.php trong thư mục install hoặc đổi tên nó.

Địa chỉ truy cập backend: Tên miền/admin

Địa chỉ truy cập trang chủ Official Account và H5: Tên miền/

Gợi ý: Nếu không truy cập được, vui lòng kiểm tra xem [URL Rewrite](https://doc.crmeb.com/web/single/crmeb_v4/1139) đã được cấu hình tốt chưa
Vui lòng ghi nhớ tài khoản và mật khẩu của bạn trong quá trình cài đặt!

## Cài đặt lại
1. Xóa cơ sở dữ liệu
2. Xóa tệp /public/install.lock

## Cài đặt thủ công
1. Tạo cơ sở dữ liệu, nhập tệp cơ sở dữ liệu
Thư mục tệp cơ sở dữ liệu /public/install/crmeb.sql
2. Sửa đổi tệp kết nối cơ sở dữ liệu
Đường dẫn tệp cấu hình /.env
~~~
APP_DEBUG = true

[APP]
DEFAULT_TIMEZONE = Asia/Shanghai

[DATABASE]
TYPE = mysql
HOSTNAME = 127.0.0.1
HOSTPORT = 3306
USERNAME = root
PASSWORD = 'root'
DATABASE = crmeb
PREFIX = eb_
CHARSET = utf8
DEBUG = true

[LANG]
default_lang = zh-cn

[REDIS]
REDIS_HOSTNAME = 127.0.0.1
PORT = 6379
REDIS_PASSWORD = 
SELECT = 0

[QUEUE]
QUEUE_NAME = crmeb
~~~
3. Sửa đổi quyền thư mục (hệ thống linux) 777

/public 

/runtime

4. Đăng nhập backend:
http://Tên miền/admin

Tài khoản mặc định: admin Mật khẩu: crmeb.com

## Hàng đợi tin nhắn
Hệ thống linux cài đặt trình quản lý Supervisor, thêm daemon

Người dùng chọn www

Thư mục chạy chọn thư mục gốc của dự án

Lệnh khởi động: php think queue:listen --queue

## Tác vụ định kỳ
Sử dụng trong các chức năng như tự động nhận hàng, cảnh báo tồn kho
```sh
php think timer [ status ] [ --d ]
```
Tham số
- status: Trạng thái
    - start: Khởi động
    - stop: Tắt
    - restart: Khởi động lại
- --d : Thực thi nền
## Dịch vụ kết nối dài
Sử dụng trong các chức năng như trò chuyện h5, thông báo tin nhắn quản trị viên backend

Trước tiên sửa đổi cấu hình nginx của trang web
~~~
location /notice {
    proxy_pass http://127.0.0.1:20002/;  
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header X-real-ip $remote_addr;
    proxy_set_header X-Forwarded-For $remote_addr;
}
location /msg {
    proxy_pass http://127.0.0.1:20003/;  
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header X-real-ip $remote_addr;
    proxy_set_header X-Forwarded-For $remote_addr;
}
~~~
Cổng tương ứng phải nhất quán với trong /config/workerman.php

Hệ thống linux chạy trực tiếp
```sh
php think workerman [ status ] [ server ] [ --d ]
```
Môi trường windows cần thực hiện theo ba bước
```sh
# Dịch vụ truyền thông nội bộ
php think workerman start channel
# Dịch vụ trò chuyện h5
php think workerman start chat
# Thông báo quản trị viên backend
php think workerman start admin
```
Hoặc chạy trực tiếp /workerman.bat bằng cách nhấp đúp

Tham số
- status: Trạng thái
    - start: Khởi động
    - stop: Tắt
    - restart: Khởi động lại
- server: Dịch vụ (windows)
    - channel: Truyền thông nội bộ
    - chat: h5
    - admin: Backend

- --d : Thực thi nền
